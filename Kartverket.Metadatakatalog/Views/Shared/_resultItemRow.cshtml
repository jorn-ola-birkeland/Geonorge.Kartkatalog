@using Kartverket.Metadatakatalog.Helpers

@{var javaScriptSerializer = new System.Web.Script.Serialization.JavaScriptSerializer(); }

@Html.Partial("VueComponents/_TableRowButtons")

@Html.Partial("VueComponents/ResultItem/_Title")
@Html.Partial("VueComponents/ResultItem/_Owner")
@Html.Partial("VueComponents/ResultItem/_OpenData")
@Html.Partial("VueComponents/ResultItem/_DistributionType")
@Html.Partial("VueComponents/ResultItem/_DistributionUrl")
@Html.Partial("VueComponents/ResultItem/_DistributionFormats")
@Html.Partial("VueComponents/ResultItem/_CopyUrl")
@Html.Partial("VueComponents/ResultItem/_Thumbnail")


<script>
    //Component
    var ResultItemComponent = {
        template: "#resultItemRow",
        name: "resultItem",
        props: ["resultItem"],
        data: function() {
            var data = {
                expanded: false,
                backgroundColor: "#fff",
                addedToCart: false,
                itemType: this.resultItem.type,
                hierarchyLevel: this.$parent.hierarchyLevel !== undefined ? this.$parent.hierarchyLevel : 0
            };
            return data;
        },
        components: {
            TableRowButtons: TableRowButtons,
            TableTitle: TableTitle,
            TableOwner: TableOwner,
            TableOpenData: TableOpenData,
            TableDistributionType: TableDistributionType,           
            TableDistributionUrl: TableDistributionUrl,
            TableDistributionFormats: TableDistributionFormats,
            TableCopyUrl: TableCopyUrl,
            Buttons: Buttons,
            thumbnail: thumbnail
        },
        computed: {
            readMoreUrl: function () {
                var organization = this.resultItem.OrganizationSeoName;
                var title = this.resultItem.TitleSeo;
                var uuid = this.resultItem.Uuid;
                var url = "/metadata/" + organization + "/" + title + "/" + uuid;
                return url;
            },
            
            // TODO ta vekk
            organizationUrl: function () {
                url = "/etatvis-oversikt/" + this.resultItem.OrganizationSeoName;
                return url;
            },
            description: function () {
                var description;
                if (this.resultItem.Abstract.length > 250) {
                    description = this.resultItem.Abstract.substring(0, 251) + " ...";
                } else {
                    description = this.resultItem.Abstract;
                }
                return description;
            }
        }
    }
</script>
